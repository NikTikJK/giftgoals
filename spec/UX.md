# UX-спецификация GiftGoals

Документ описывает UX‑требования для веб‑приложения социального вишлиста GiftGoals на основе текущего PRD. Бизнес‑логика и роли берутся из `spec/PRD.md`.

## 1. Роли и общие принципы

- **Гость**:
  - попадает на публичный вишлист по ссылке без авторизации;
  - видит вишлист полностью (шапка, все подарки, статусы, прогресс сборов);
  - не видит личностей резервистов и вкладчиков;
  - не может резервировать подарки и вносить вклад — при попытке действия получает модальное окно с предложением войти или зарегистрироваться, оставаясь на текущей странице.

- **Друг (залогиненный пользователь, не владелец вишлиста)**:
  - может открыть вишлист по публичной ссылке;
  - видит всё то же, что гость;
  - дополнительно может:
    - резервировать обычные подарки;
    - вносить вклад в групповой сбор по «дорогим» подаркам;
    - (Phase 2) предлагать новые подарки владельцу;
  - видит личности резервистов (имя/аватар), но не видит, кто и сколько внёс в сбор (только прогресс и, опционально, анонимное количество участников).

- **Владелец вишлиста**:
  - управляет своими вишлистами из личного кабинета (создание/редактирование/удаление);
  - по публичной ссылке на свой вишлист:
    - видит тот же контент, что Друг;
    - не видит, кто резервировал и кто сколько внёс в сбор;
    - **не имеет кнопок** «Зарезервировать» и «Скинуться» (не может участвовать в своём же вишлисте как Друг);
  - (Phase 2) управляет очередью предложенных подарков.

Общие принципы UX:
- чётко показать, в какой роли сейчас пользователь (гость / друг / владелец);
- не допускать потери контекста при логине/регистрации из публичного вишлиста;
- минимизировать «тихие» отказы — любые ограничения должны сопровождаться понятными сообщениями.

## 2. Визуальный стиль и UI

Этот раздел дополняет PRD (`spec/PRD.md`) и UX‑потоки в этом документе. Здесь описаны визуальные решения (цвета, шрифты, отступы, компоненты и их состояния), на основе которых frontend‑разработчик может реализовать интерфейс.

### 2.1. Цветовая палитра

- **Основные токены**:
  - `color-primary` — #2563EB (насыщенный синий, основной цвет действий: основные кнопки, активные ссылки).
  - `color-primary-soft` — #DBEAFE (мягкий фон для выделения блоков и состояний, связанных с primary).
  - `color-accent` — #F97316 (оранжевый акцент: отдельные важные CTA, элементы прогресса).
  - `color-success` — #16A34A (успех: подтверждения действий, завершённый сбор).
  - `color-warning` — #FACC15 (предупреждения: недобор, лимиты, мягкие предупреждения).
  - `color-danger` — #DC2626 (ошибки: невозможность резерва/вклада, критические сообщения).
  - `color-neutral-900` — #0F172A (основной тёмный текст).
  - `color-neutral-700` — #334155 (вторичный текст, подписи).
  - `color-neutral-500` — #64748B (мутed текст, подсказки).
  - `color-neutral-200` — #E5E7EB (границы, разделители).
  - `color-neutral-50` — #F9FAFB (фон карточек и поверхностей).
  - `color-background` — #FFFFFF (основной фон страницы).
  - `color-border` — #E5E7EB (границы инпутов, карточек, модалок).
  - `color-overlay` — rgba(15, 23, 42, 0.5) (фон под модалками).

- **Статусы подарков и сборов**:
  - `status-free` — текст/иконка в `color-neutral-700`, фон по умолчанию.
  - `status-reserved` — бейдж с фоном `color-primary-soft`, текстом `color-primary`.
  - `status-collect-open` — прогресс‑бар в `color-primary`, фон прогресса в `color-neutral-200`.
  - `status-collect-complete` — прогресс‑бар/бейдж в `color-success` с более насыщенной полосой.
  - `status-collect-underfunded` — акцент `color-warning` (фон/иконка), текст нейтральный.

- **Темы**:
  - На MVP используется **только светлая тема** (значения выше).
  - Поддержка тёмной темы может быть добавлена позже как отдельное расширение (переопределение тех же токенов для тёмного фона).

### 2.2. Типографика

- **Базовый шрифт**:
  - Семейство: system UI (например, `-apple-system, BlinkMacSystemFont, \"Segoe UI\", sans-serif`).

- **Размеры и веса (токены)**:
  - `font-size-xs` — 0.75rem (12px);
  - `font-size-sm` — 0.875rem (14px);
  - `font-size-md` — 1rem (16px, базовый текст);
  - `font-size-lg` — 1.125rem (18px);
  - `font-size-xl` — 1.5rem (24px, основные заголовки).
  - `font-weight-regular` — 400;
  - `font-weight-medium` — 500;
  - `font-weight-semibold` — 600.

- **Иерархия**:
  - Заголовок страницы (H1): `font-size-xl`, `font-weight-semibold`, `color-neutral-900`.
  - Подзаголовки блоков (H2/H3): `font-size-lg` или `font-size-md`, `font-weight-medium`.
  - Текст карточек, формы: `font-size-md`, `font-weight-regular`, `color-neutral-900`.
  - Подписи к полям, подсказки: `font-size-sm`, `color-neutral-500`.
  - Текст ошибок: `font-size-sm`, `color-danger`, `font-weight-medium`.
  - Текст статусов/бейджей: `font-size-xs` или `font-size-sm` в зависимости от контекста.

### 2.3. Сетка, отступы, радиусы, тени

- **Сетка и spacing**:
  - Базовый шаг: 4px.
  - Токены:
    - `spacing-xs` — 4px;
    - `spacing-sm` — 8px;
    - `spacing-md` — 12px;
    - `spacing-lg` — 16px;
    - `spacing-xl` — 24px;
    - `spacing-2xl` — 32px.
  - Принципы:
    - вертикальный ритм между блоками строится на кратных `spacing-md`/`spacing-lg`;
    - отступы внутри карточек — `spacing-md` по сторонам, между элементами — `spacing-sm`/`spacing-md`.

- **Радиусы**:
  - `radius-sm` — 4px (input, бейджи, маленькие элементы);
  - `radius-lg` — 8px (карточки, модалки, тосты).

- **Тени**:
  - `shadow-sm`: `0 1px 2px rgba(15, 23, 42, 0.06)`;
  - `shadow-md`: `0 4px 12px rgba(15, 23, 42, 0.12)`.
  - Применение:
    - `shadow-sm` — для карточек и ховеров;
    - `shadow-md` — для модалок и тостов, чтобы визуально выделить их над контентом.

### 2.4. Базовые UI‑компоненты (атомы)

- **Кнопки**:
  - Варианты:
    - `btn-primary`: фон `color-primary`, текст `#FFFFFF`;
    - `btn-secondary`: фон `color-neutral-50`, текст `color-neutral-900`, бордер `color-neutral-200`;
    - `btn-ghost`: без фона, текст `color-primary`, фон `color-primary-soft` при наведении;
    - `btn-danger`: фон `color-danger`, текст `#FFFFFF`.
  - Состояния:
    - `default`: как описано выше;
    - `hover`: небольшое затемнение фона или усиление тени;
    - `active`: чуть более тёмный фон, без анимаций в MVP;
    - `disabled`: фон и текст в `color-neutral-200/500`, курсор `not-allowed`;
    - `focus-visible`: явная обводка (outline 2px) с контрастным цветом (например, `#1D4ED8`).

- **Поля ввода**:
  - Фон `#FFFFFF`, бордер `color-neutral-200`, радиус `radius-sm`;
  - `focus`: бордер `color-primary`, лёгкая тень;
  - `error`: бордер и иконка/текст ошибки в `color-danger`;
  - `disabled`: фон `color-neutral-50`, текст `color-neutral-500`.

- **Чекбоксы/радио**:
  - Размер ~16px, радиус 4px для чекбокса, 50% для радио;
  - активное состояние — заливка `color-primary`, иконка галочки/точки белая.

- **Иконки**:
  - Размер базовый 16–20px;
  - Стиль: простые линейные/заливочные иконки без излишних деталей, цвета привязывать к токенам статусов (`success`, `warning`, `danger`, `primary`).

### 2.5. Доступность (a11y)

- Минимальные требования:
  - контраст текста и фона для основного текста и CTA ≥ WCAG AA;
  - все интерактивные элементы (кнопки, ссылки, поля, карточки с кликом) имеют явный фокус‑стиль;
  - основные потоки (регистрация, вход, резерв, вклад) доступны с клавиатуры без мыши.
- ARIA‑паттерны:
  - модалки — с `aria-modal`, фокус‑ловушкой и корректным возвратом фокуса;
  - тосты — помечены как `role=\"status\"` или `role=\"alert\"` в зависимости от важности;
  - прогресс‑бар — с `role=\"progressbar\"` и атрибутами `aria-valuemin/max/now`.

## 2. Пользовательские потоки

### 2.1. Регистрация и вход

**Регистрация**
- Точка входа:
  - кнопка «Зарегистрироваться» на лэндинге;
  - ссылка из модалки гостя при попытке зарезервировать/скинуться.
- Форма:
  - поля: email, пароль, (опционально) подтверждение пароля;
  - валидация: корректный email, пароль не короче N символов (конкретное N фиксируется при реализации), сообщения об ошибках под полями;
  - ссылка «Уже есть аккаунт? Войти».
- После успешной регистрации:
  - пользователь автоматически авторизован;
  - перенаправление:
    - если он пришёл из публичного вишлиста — обратно на этот вишлист, с восстановлением действия (например, повторное открытие карточки подарка для резерва);
    - иначе — в личный кабинет (`Вишлисты`).

**Вход**
- Точка входа:
  - кнопка «Войти» на лэндинге/в хедере;
  - ссылка из модалки гостя.
- Форма:
  - поля: email, пароль;
  - кнопка «Войти через Google»;
  - ссылка «Создать аккаунт».
- После успешного входа:
  - аналогично регистрации — возврат к исходной странице (если был публичный вишлист) или переход в личный кабинет.

### 2.2. Личный кабинет владельца

**Список вишлистов**
- Экран `Вишлисты`:
  - список карточек вишлистов:
    - название;
    - дата события (если есть);
    - количество подарков;
    - индикатор наличия активных сборов;
  - сверху кнопка «Создать вишлист».
- Действия с карточкой:
  - «Открыть» (переход в режим владельца для управления);
  - «Публичная ссылка» (копирование URL);
  - «Редактировать» (название, описание, дата, настройки порога);
  - «Удалить» (подтверждающая модалка с предупреждением об аннулировании резервов/вкладов).

**Создание / редактирование вишлиста**
- Форма:
  - название (обязательно);
  - описание / повод (опционально);
  - дата события (опционально, но рекомендуется);
  - порог «дорогой» (значение по умолчанию 5000 ₽, можно изменить);
  - опция включения/отключения публичной ссылки.
- На этой же форме или сразу после создания:
  - возможность добавить первые подарки (см. 2.3).

### 2.3. Управление подарками

**Добавление/редактирование подарка**
- Модальное окно или отдельный экран:
  - название (обязательно);
  - ссылка на товар (URL);
  - ориентировочная цена (в рублях, целое или с копейками);
  - картинка (URL или загрузка; для MVP достаточно поля URL);
  - комментарий (опционально).
- Отдельно отображается:
  - текущий порог «дорогой» для этого вишлиста;
  - информация о том, что тип (обычный/дорогой) определяется автоматически по цене.
- При редактировании дорогого подарка с уже существующими вкладами:
  - UX должен явно предупредить, что изменение цены изменит целевую сумму сбора (но не уже собранную часть).

**Список подарков**
- Для владельца:
  - полный список подарков с:
    - типом (обычный/дорогой);
    - статусом (свободен/зарезервирован/сбор открыт/сбор завершён/сбор недобор);
    - для дорогих — прогресс‑бар `собрано / цель`;
  - действия:
    - «Редактировать»;
    - «Удалить» (подтверждение с текстом про аннулирование резерва/вкладов).

### 2.4. Просмотр вишлиста по ссылке

**Гость**
- Видит:
  - шапку (название, дата события, описание);
  - все подарки;
  - статусы подарков и прогресс сборов.
- При клике по:
  - «Зарезервировать» или «Скинуться»:
    - всплывает модалка:
      - короткое объяснение, что для действия нужна регистрация/вход;
      - кнопки «Войти» и «Зарегистрироваться»;
      - крестик / «Отмена»;
    - после логина/регистрации возвращается на тот же вишлист и тот же подарок.

**Друг (залогинен, не владелец)**
- У видимых элементов:
  - для обычного подарка:
    - либо кнопка «Зарезервировать», если подарок свободен;
    - либо текст «Зарезервировано» +, опционально, имя/аватар резервиста;
  - для дорогого подарка:
    - форма/кнопка «Скинуться» (ввод суммы);
    - прогресс‑бар и сумма;
    - статус «Сбор завершён» при полной сумме;
  - при ошибке (подарок уже зарезервирован, цель достигнута) — тост или сообщение рядом с карточкой.

**Владелец по ссылке**
- Видит тот же список и статусы, что Друг;
- **Не видит** кнопок «Зарезервировать» и «Скинуться»;
- Может иметь кнопку «Открыть в режиме владельца» (переход в кабинет на соответствующий вишлист).

### 2.5. Резервирование

- Поток для друга:
  - нажимает «Зарезервировать»;
  - опционально — модалка подтверждения («Вы уверены, что хотите зарезервировать этот подарок?»);
  - при успехе:
    - статус меняется на «Зарезервировано»;
    - другим пользователям статус обновляется через реалтайм/повторный запрос;
    - показывается тост «Подарок зарезервирован».
  - при ошибке (уже зарезервирован):
    - сообщение «К сожалению, кто‑то уже успел зарезервировать этот подарок»;
    - статус обновляется в UI.
- Снятие резерва:
  - доступно до даты события (если она есть);
  - инициируется из карточки («Снять резерв»);
  - после даты события кнопка скрывается/становится неактивной.

### 2.6. Групповой сбор

- Поток для друга:
  - на карточке дорогого подарка:
    - видит цель (сумма), собрано, прогресс;
    - вводит сумму вклада;
    - система проверяет, что вклад не переполнит цель; при необходимости может автоматически подставить «максимально допустимый» вклад;
    - при успехе:
      - прогресс обновляется;
      - показывается тост «Вклад учтён».
    - при попытке переполнить цель:
      - сообщение об ошибке и предложение скорректировать сумму.
- Недобор и продление:
  - при наступлении даты события и недоборе:
    - статус подарка показывает, что цель не достигнута;
    - после решения владельца о продлении — дата и статус обновляются.

### 2.7. Предложения подарков (Phase 2)

- Поток для друга:
  - кнопка «Предложить подарок» на публичном вишлисте (только для залогиненных Друзей);
  - модалка с полями, как у обычного подарка;
  - после отправки:
    - предложение исчезает из интерфейса друга (только сообщение «Ваше предложение отправлено владельцу»);
    - попадает в очередь у владельца.
- Поток для владельца:
  - в режиме управления вишлистом видит отдельный список «Предложения»;
  - по каждому — минимальная информация о подарке и две кнопки:
    - «Принять» — подарок добавляется в общий список подарков;
    - «Отклонить» — предложение исчезает из очереди;
  - нигде не отображается, кто предложил подарок.

## 3. Структура экранов и навигации

Основные разделы SPA:

- `Главная` (опционально):
  - краткое описание продукта;
  - CTA: «Войти» / «Зарегистрироваться».
- `Вишлисты` (кабинет владельца):
  - список вишлистов;
  - кнопка «Создать вишлист».
- `Детали вишлиста (режим владельца)`:
  - шапка вишлиста;
  - список подарков с действиями владельца;
  - (Phase 2) вкладка/блок «Предложения».
- `Публичный вишлист` (по slug):
  - один и тот же URL для гостя/друга/владельца, но разный набор доступных действий.
- `Профиль / Настройки`:
  - смена имени;
  - смена пароля;
  - выход.

Навигация:
- верхнее меню (для залогиненных): «Вишлисты», «Профиль», «Выход»;
- для незалогиненных: «Войти», «Зарегистрироваться»;
- доступ к публичному вишлисту — только по прямой ссылке.

## 4. Состояния и статусы

### 4.1. Подарки

- Статусы:
  - `свободен`;
  - `зарезервирован`;
  - `сбор открыт`;
  - `сбор завершён` (цель достигнута);
  - `сбор недобор` (дата события прошла, цель не достигнута).
- Для дорогих подарков всегда отображается прогресс и целевая сумма.

### 4.2. Вишлист

- С датой события:
  - влияет на:
    - возможность снятия резерва;
    - отправку уведомлений о недоборе;
    - статусы сборов.
- Без даты события:
  - снятие резерва доступно всегда;
  - уведомления о недоборе не отправляются, пока владелец не установит дату при продлении.

### 4.3. Резервы и вклады

- Для владельца:
  - видит только факт наличия резерва по подарку;
  - видит только суммарный прогресс по сбору, без разбивки по людям.
- Для друга:
  - видит, какие подарки зарезервированы и кем (имя/аватар);
  - по сбору видит прогресс и, опционально, число участников (без имён и сумм).
- Для гостя:
  - видит только факт резерва и прогресс сборов без деталей.

## 5. Ошибки и крайние случаи

Ключевые UX‑ошибки:

- Подарок уже зарезервирован к моменту запроса:
  - показать сообщение и обновить карточку.
- Вклад переполняет цель:
  - сообщение об ошибке, подсказка скорректировать сумму (например, «максимально доступно X»).
- Лимиты:
  - при попытке создать > 50 вишлистов, > 200 подарков или превышении лимита предложений — понятное сообщение, какое ограничение сработало.
- Недоступный вишлист:
  - удалён или скрыт — отдельный экран/сообщение.

## 6. Реалтайм и уведомления (UX)

- При изменения статуса подарка или прогресса сбора:
  - обновлять данные на странице (через polling/SSE) без перезагрузки;
  - по возможности отображать ненавязчивый индикатор обновления.
- In-app уведомления:
  - глобальный индикатор (значок колокольчика / счётчик);
  - список уведомлений с краткими описаниями (новые резервы, новые вклады, недобор, продление сбора, принятые/отклонённые предложения в Phase 2).

## 7. MVP vs Phase 2

- **MVP**:
  - все сценарии из раздела 7 PRD (регистрация/вход, личный кабинет, создание/редактирование/удаление вишлистов и подарков, публичный вишлист, резервирование, групповой сбор, реалтайм‑обновления, адаптивность);
  - базовые in-app уведомления.
- **Phase 2**:
  - предложения подарков;
  - расширенные настройки уведомлений и профиля.


# План бесплатной разработки iOS-приложения (Capacitor, без Mac и без $99)

## Ограничения бесплатного варианта

- **Нет Mac** — сборка только в облачном CI (GitHub Actions и т.п.).
- **Нет Apple Developer ($99)** — на свой iPhone только установка на **7 дней** (потом переустановить); TestFlight и App Store недоступны.
- **Цель:** прототип, демо, проверка на устройстве, показ заказчику/инвестору.

---

## Этап 1. Подготовка (один раз)

| Что | Действие |
|-----|----------|
| **Apple ID** | Бесплатный аккаунт на appleid.apple.com — для подписи приложения в CI. |
| **Репозиторий** | Код в GitHub (или другом сервисе с бесплатным CI на macOS). |
| **Локально** | Windows, Node.js, проект `frontend` (React + Vite). |

---

## Этап 2. Capacitor в проекте (локально на Windows)

1. В папке **frontend**:
   ```bash
   npm install @capacitor/core @capacitor/cli @capacitor/ios
   npx cap init
   npx cap add ios
   ```
2. В конфиге Capacitor указать `webDir: 'dist'`, нужные `appId` и `appName`.
3. Проверить сборку:
   ```bash
   npm run build
   npx cap sync ios
   ```
4. Закоммитить и запушить, включая папку **ios/** (чтобы CI мог собирать без `cap add` на каждом прогоне).

---

## Этап 3. Сборка iOS в облаке (бесплатно)

- **Сервис:** GitHub Actions с `runs-on: macos-latest` (есть бесплатные минуты для приватных/публичных репо).
- **Шаги job'а:**
  1. Checkout репо.
  2. Установить Node, перейти в `frontend`, `npm ci`, `npm run build`.
  3. `npx cap sync ios` (или уже готовый `ios/` из репо).
  4. Установить Xcode (или использовать образ с Xcode).
  5. Собрать проект через `xcodebuild` для симулятора (например, `generic/platform=iOS Simulator`) — получится .app или .ipa для симулятора.
  6. Для установки на **реальный iPhone на 7 дней**: подпись бесплатным Apple ID (development certificate + provisioning profile). В CI это делают через `fastlane match` или вручную — загрузить сертификат и профиль в секреты и подписывать сборку. Артефакт — .ipa, скачиваешь и ставишь через Finder (при подключённом Mac у друга) или через сервисы вроде Diawi (загружаешь .ipa, даёшь ссылку на установку).

Подпись бесплатным Apple ID в CI — самая муторная часть: нужен один раз сгенерированный на Mac (или через облачный Mac) development certificate и provisioning profile, положить их в секреты репо и использовать в workflow.

---

## Этап 4. Тестирование

| Где | Как |
|-----|-----|
| **Симулятор** | В CI собрать под симулятор, скачать .app/.ipa и открыть в симуляторе (нужен доступ к Mac или облачному Mac с симулятором). Либо добавить в CI шаг запуска симулятора и базовых тестов. |
| **Свой iPhone (7 дней)** | Собрать в CI под реальное устройство с подписью бесплатным Apple ID, скачать .ipa, установить через Diawi / или с чужого Mac через Finder. Через 7 дней — переустановить. |
| **Локально на Windows** | Только веб: `npm run dev` и проверка в браузере или в инструментах под мобильный viewport. |

---

## Этап 5. Типовой workflow при разработке

1. Меняешь код в **frontend** на Windows.
2. Локально: `npm run build` (и при необходимости `npx cap sync ios` и коммит `ios/`).
3. Пушишь в GitHub → запускается workflow.
4. Скачиваешь артефакт (сборка под симулятор или под устройство).
5. Тестируешь: симулятор (если есть доступ к Mac) или свой iPhone (переустановка раз в 7 дней).

---

## Чек-лист

1. Создать бесплатный Apple ID (если ещё нет).
2. В **frontend**: установить Capacitor, `cap init`, `cap add ios`, настроить конфиг, закоммитить `ios/`.
3. В репо добавить GitHub Actions workflow: macOS, Node, build frontend, `cap sync ios`, сборка Xcode (симулятор и/или устройство с подписью бесплатным Apple ID).
4. Один раз настроить подпись: сгенерировать на Mac (своём/друга/облачном) development certificate и provisioning profile для твоего Apple ID и устройства, положить в секреты и использовать в workflow.
5. Запустить workflow, скачать артефакт, поставить на iPhone (через Diawi или с Mac) и пользоваться 7 дней; при необходимости повторять.

---

## Когда понадобятся деньги

- Постоянная установка на iPhone без переустановки раз в 7 дней → **Apple Developer $99/год**.
- TestFlight / App Store → **$99/год**.
- Свой Mac — по желанию, для удобства; без него план остаётся выполнимым за счёт CI и 7-дневной установки.
